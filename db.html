<html>
  <head>
    <link href="css/bootstrap.css" rel="stylesheet">
    <script type="text/javascript" src="js/jquery-1.12.2.min.js"></script>
    <script type="text/javascript" src="js/bootstrap.min.js"></script>
    <script src="js/fdb-all.min.js"></script>
  </head>
  <body>
    <table class="table table-hover">
      <thead>
        <tr>
          <td>id</td>
          <td>姓名</td>
          <td></td>
        </tr>
      </thead>
      <tbody>
        
      </tbody>
    </table>
    <script>
      function rnd(min, max) {
        return Math.floor(Math.random() * max) + min;
      }
      var count = 0;
      var stuNum = 0;
      var names = ["apple","pen","pineapple","ppap","fool"];
      var subjects = ["English","Math","Chinese","History"];
      var genders = ["male","female"];
      var fdb = new ForerunnerDB();
      var db = fdb.db("04db2");
      var studentCollection = db.collection('students');
      var scoreCollection = db.collection('scores');
      loadInfo();
      $('body').on("click",".btn")
      function newStudent(num){
        for(var i = 1;i <= num;i = i+1){
          var Stu = new stu(i);
          stuNum = stuNum + 1;
          studentCollection.insert(Stu);
        }
      }
      function newScore(num){
        for(var i = 0;i < num;i = i+1){
          var Score = new score();
          scoreCollection.insert(Score);
        }
      }
      function stu(id){
        this.age = rnd(0,100);
        this.name = names[rnd(0,4)];
        this.gender = genders[rnd(0,1)];
        this.id = id;
      }
      function score(){
        this.id = rnd(1,50);
        this.subject = subjects[rnd(0,3)];
        this.number = rnd(0,100);
      }
      function saveInfo(){
        studentCollection.save();
        scoreCollection.save();
      }
      function loadInfo(){
        studentCollection.load(read);
        scoreCollection.load(read);
      }
      function read(){
        count+=1;
        var s = studentCollection.find()
        if(count >= 2){
        for(var i = 0;i < studentCollection.find().length;i = i+1){
          $("tbody").append("<tr><td>"+s[i]['id']+"</td><td>"+s[i]['name']+"</td><td>"+'<a class="btn btn-default" data-id="'+s[i]['id']+'">detail</a>'+"</td></tr>");
        }
        console.log("學生人數:"+studentCollection.find().length);
        console.log("分數總量:"+scoreCollection.find().length);
      }
      }
    </script>
  </body>
</html>
